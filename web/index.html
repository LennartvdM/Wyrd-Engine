<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Synthetic Calendar Generator</title>
    <link
      rel="stylesheet"
      href="https://unpkg.com/vis-timeline@9.5.1/styles/vis-timeline-graph2d.min.css"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header class="page-header">
      <h1>Synthetic Calendar Generator</h1>
      <p>
        Generate weekly schedules from configuration JSON and explore the results in
        a familiar calendar interface powered by FullCalendar.
      </p>
    </header>

    <nav class="page-nav" aria-label="Primary">
      <button
        type="button"
        class="page-nav__link is-active"
        data-view-target="calendar"
      >
        Calendar
      </button>
      <button
        type="button"
        class="page-nav__link"
        data-view-target="test-console"
      >
        Test Console
      </button>
    </nav>

    <main class="page-layout view" data-view="calendar">
      <section class="card form-card">
        <h2>Configuration</h2>
        <form id="config-form" novalidate>
          <div class="form-row">
            <label for="start-date">Week starting (optional)</label>
            <input id="start-date" name="start-date" type="date" />
            <p class="help-text">Leave blank to start on the current week&#8217;s Monday.</p>
          </div>
          <div class="form-row">
            <label for="config-input">Configuration JSON</label>
            <textarea
              id="config-input"
              name="config-input"
              spellcheck="false"
              rows="20"
            ></textarea>
            <p class="help-text">
              Provide the same JSON structure used by <code>calendar_gen.py</code>.
            </p>
          </div>
          <div class="form-actions">
            <button type="submit">Generate schedule</button>
          </div>
          <p class="form-error" id="form-error" role="alert"></p>
        </form>
      </section>

      <section class="card hidden results-card" id="results">
        <div class="results-header">
          <div>
            <h2 id="results-title">Generated schedule</h2>
            <p id="results-subtitle"></p>
          </div>
          <button type="button" id="download-json" disabled>Download JSON</button>
        </div>
        <div class="results-body">
          <aside class="summary">
            <h3>Weekly totals</h3>
            <div class="totals" id="totals"></div>
          </aside>
          <div class="calendar-wrapper">
            <div class="calendar-warning hidden" id="calendar-warning">
              FullCalendar failed to load. Check your network connection and reload the page.
            </div>
            <div id="calendar"></div>
          </div>
        </div>
        <details class="raw-json">
          <summary>Raw JSON output</summary>
          <pre id="json-output"></pre>
        </details>
      </section>
    </main>

    <main class="view view--test-console hidden" data-view="test-console">
      <section class="card test-console-card">
        <div class="test-console-header">
          <div>
            <h2>Test Console</h2>
            <p class="test-console-subtitle">
              Experiment with scripted scenarios using the Wyrd runtime.
            </p>
          </div>
          <button type="button" id="test-console-run" disabled>Run</button>
        </div>
        <div class="test-console-body">
          <aside class="test-console-sidebar">
            <div class="form-row">
              <label for="test-console-script">Script</label>
              <select id="test-console-script" name="test-console-script">
                <option value="">Select a script…</option>
                <option value="daily_summary">Daily summary</option>
                <option value="custom">Custom script</option>
              </select>
            </div>
            <div class="form-row">
              <label for="test-console-input">Input JSON</label>
              <textarea
                id="test-console-input"
                name="test-console-input"
                rows="12"
                spellcheck="false"
                placeholder='{"events": []}'
              ></textarea>
              <p class="help-text">
                Provide JSON parameters that will be passed to the selected script.
              </p>
            </div>
          </aside>
          <div class="test-console-outputs">
            <div class="output-panel">
              <div class="output-panel-header">
                <h3>Stdout</h3>
              </div>
              <pre id="test-console-stdout">Waiting for execution…</pre>
            </div>
            <div class="output-panel">
              <div class="output-panel-header">
                <h3>Stderr</h3>
              </div>
              <pre id="test-console-stderr">No errors yet.</pre>
            </div>
            <div class="output-panel">
              <div class="output-panel-header">
                <h3>Result</h3>
              </div>
              <pre id="test-console-result">No output yet.</pre>
            </div>
          </div>
        </div>
        <div class="test-console-status" role="status" aria-live="polite">
          <span class="status-indicator" aria-hidden="true"></span>
          <span id="test-console-status-text">Pyodide loading…</span>
        </div>
      </section>
    </main>

    <footer class="page-footer">
      <p>
        Built for the Synthetic Calendar Generator MVP. View the
        <a href="../calendar_gen.py">Python implementation</a> for CLI usage.
      </p>
    </footer>

    <template id="event-row-template">
      <div class="event-row">
        <div class="event-time"></div>
        <div class="event-activity"></div>
        <div class="event-duration"></div>
      </div>
    </template>
    <script src="https://unpkg.com/vis-timeline@9.5.1/standalone/umd/vis-timeline-graph2d.min.js"></script>
    <script src="app.js" type="module"></script>
  </body>
</html>
